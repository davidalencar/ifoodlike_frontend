<app-nav-back title="Lista de separação" [route]="['/', dashBoardService.currentStore, 'sales']"></app-nav-back>

<h2>Items simples</h2>
<ul class="list-group" *ngIf="groupItems.simple != undefined">
    <ng-container *ngFor="let p of dashBoardService.ordeLineProductByName(groupItems.simple)">
        <li class="list-group-item">
            <div class="container">
                <div class="row">
                    <div class="col">
                        {{ p.product }}
                    </div>
                    <div class="col">
                        {{ p.qty }}
                    </div>
                </div>
            </div>
        </li>

    </ng-container>
</ul>

<h2>Items compostos</h2>
<ul class="list-group" *ngIf="groupItems.simple != undefined">
    <ng-container *ngFor="let p of dashBoardService.ordeLineProductByName(groupItems.compose)">
        <li class="list-group-item">
            <div class="container">
                <div class="row">
                    <div class="col">
                        {{ p.product }}
                    </div>
                    <div class="col">
                        {{ p.qty }}
                    </div>
                </div>
            </div>
        </li>

    </ng-container>
</ul>


<h2>Pedidos</h2>

<ul class="list-group">
    <li class="list-group-item" *ngFor="let s of dashBoardService.salesPickingList">
        <div class="container">
            <div class="row">
                <div class="col-4">
                    Ordem:
                </div>
                <div class="col-4">
                    <input type="number" inputmode="numeric" name="deliveryOrder" class="form-control" 
                    [(ngModel)]="s.deliveryOrder" required pattern="[0-9]">
                    
                </div>

            </div>
            
            <div class="row">
                <div class="col-2">
                    {{storeService.formatSalesId(s.salesId)}}
                </div>
                <div class="col-8">
                    <span>
                        Cliente: {{ s.cust.name}}
                    </span>
                </div>
            </div>
            <div class="row question">
                <div class="col">
                    <span class="question-title">
                        Endereço:
                    </span>
                </div>
            </div>
            <div class="row">
                <div class="col">
                    {{ dashBoardService.formatDeliveryAddressL1(s)}}<br>
                    {{ dashBoardService.formatDeliveryAddressL2(s)}}<br>
                    Telefone: {{ s.cust.phone}}
                </div>
            </div>
            <div class="row question">
                <div class="col">
                    <span class="question-title">
                        Items
                    </span>
                </div>
            </div>
            <ng-container *ngFor="let l of s.lines">
                <div class="row">
                    <div class="col-2">
                        <span class="text-success">{{ l.qty }}X</span>
                    </div>
                    <div class="col">
                        <span class="font-weight-normal"> {{ l.product }} </span>
                    </div>
                </div>
                <div class="row" *ngFor="let c of l.items">
                    <div class="col text-muted">
                        {{c.category}}
                        <ul>
                            <li *ngFor="let i of c.items">
                                <span *ngIf="i.qty > 1">{{ i.qty }}X </span>
                                {{i.item}}
                            </li>
                        </ul>
                    </div>
                </div>
            </ng-container>
            <div class="row question" *ngIf="s.instruction">
                <div class="col-2">
                    <span class="question-title">
                        Obs.:
                    </span>
                </div>
                <div class="col">
                    {{ s. instruction }}
                </div>
            </div>
            <div class="row question">
                <div class="col-3">
                    <span class="question-title">
                        Taxas:
                    </span>
                </div>
            </div>
            <div class="row text-muted" *ngFor="let t of s.taxes">
                <div class="col">
                    {{ t.name }}
                </div>
                <div class="col-3">
                    {{ storeService.formatPrice(t.value)}}
                </div>
            </div>
            <div class="row question">
                <div class="col">
                    <span class="question-title">
                        Total:
                    </span>
                </div>
                <div class="col-3">
                    <span class="text-success font-weight-bold">
                        {{ storeService.formatPrice(s.totalAmount) }}
                    </span>
                </div>
            </div>

            <div class="row question">
                <div class="col-3">
                    <span class="question-title">
                        Pagamento:
                    </span>
                </div>
                <div class="col">
                    <label *ngIf="s.paymMethod == 'credit'" class="text-center">
                        <p class="paymmodename">Cartão</p>
                    </label>
                    <label *ngIf="s.paymMethod == 'money'" class="text-center">
                        <p class="paymmodename">Dinheiro</p>
                    </label>
                    <label *ngIf="s.paymMethod == 'transfer'" class="text-center">

                        <p class="paymmodename">Transferência</p>
                    </label>
                </div>
            </div>
        </div>
    </li>
</ul>
<nav class="navbar fixed-bottom navbar-expand-lg navbar-light bg-light ">
    <div class="container justify-content-between">
        <button class="btn btn-lg btn-success btn-confirm" (click)="onSendPickingList()" >
            Enviar
        </button>
        <button class="btn btn-lg btn-success btn-confirm" (click)="onOrderSales()" >
            Organizar
        </button>
    </div>
</nav>